# 專案架構文檔

## 🏗️ 整體架構

這是一個採用模組化設計的部落格專案，整合了前端靜態網站和後端 API 服務。

```
┌─────────────────────────────────────────────────────────────┐
│                    My Blog Project                          │
│                    模組化架構                               │
└─────────────────────────────────────────────────────────────┘
                                │
        ┌───────────────────────┼───────────────────────┐
        │                       │                       │
        ▼                       ▼                       ▼
┌───────────────┐    ┌─────────────────┐    ┌─────────────────┐
│ Jekyll Blog  │    │   FastAPI API   │    │   Kubernetes    │
│   模組       │    │     模組        │    │    部署配置     │
└───────────────┘    └─────────────────┘    └─────────────────┘
        │                       │                       │
        ▼                       ▼                       ▼
┌───────────────┐    ┌─────────────────┐    ┌─────────────────┐
│ 靜態網站     │    │  RESTful API    │    │  容器編排      │
│ 端口: 30081  │    │  端口: 30080    │    │  自動擴展      │
└───────────────┘    └─────────────────┘    └─────────────────┘
```

## 📁 目錄結構

```
my_blog_project/
├── README.md                           # 主專案說明
├── .github/                            # GitHub Actions
│   └── workflows/
│       ├── cd.yml                      # 主 CD 流程
│       └── cd-single.yml               # 單容器 CD 流程
├── modules/                            # 模組目錄
│   ├── jekyll-blog/                   # Jekyll 部落格模組
│   │   ├── Dockerfile                 # 容器化配置
│   │   ├── _config.yml                # Jekyll 配置
│   │   ├── _posts/                    # 部落格文章
│   │   ├── assets/                    # 靜態資源
│   │   └── README.md                  # 模組說明
│   └── fastapi-api/                   # FastAPI API 模組
│       ├── Dockerfile                 # 容器化配置
│       ├── app/                       # 應用程式代碼
│       ├── requirements.txt            # Python 依賴
│       └── README.md                  # 模組說明
├── k8s/                               # Kubernetes 配置
│   ├── namespace.yaml                 # 命名空間
│   ├── configmap.yaml                 # 配置映射
│   ├── deployment-single.yaml         # Jekyll 部署
│   ├── service-single.yaml            # Jekyll 服務
│   └── kustomization-single.yaml      # Kustomize 配置
├── scripts/                           # 部署腳本
├── docs/                              # 專案文檔
│   ├── PROJECT_ARCHITECTURE.md        # 本檔案
│   ├── DEPLOYMENT.md                  # 部署指南
│   └── INTEGRATION.md                 # 整合指南
└── .gitignore                         # Git 忽略檔案
```

## 🔄 模組間關係

### 1. 獨立性
- 每個模組都是獨立的，可以單獨開發和測試
- 模組間通過標準化的介面進行通信
- 可以獨立部署和擴展

### 2. 整合點
- 共享的 Kubernetes 配置
- 統一的 CI/CD 流程
- 一致的部署策略

### 3. 依賴關係
```
Jekyll Blog ←── 獨立模組
     ↓
FastAPI API ←── 獨立模組
     ↓
Kubernetes ←── 部署平台
```

## 🚀 部署架構

### 當前部署（單容器）
```
┌─────────────────────────────────────┐
│         Kubernetes Cluster          │
│                                     │
│  ┌─────────────────────────────┐    │
│  │      my-blog-project        │    │
│  │         Namespace           │    │
│  │                             │    │
│  │  ┌─────────────────────┐    │    │
│  │  │  Jekyll Blog Pod    │    │    │
│  │  │   Port: 4000        │    │    │
│  │  └─────────────────────┘    │    │
│  │                             │    │
│  │  ┌─────────────────────┐    │    │
│  │  │  NodePort Service   │    │    │
│  │  │   Port: 30081       │    │    │
│  │  └─────────────────────┘    │    │
│  └─────────────────────────────┘    │
└─────────────────────────────────────┘
```

### 未來擴展（多容器）
```
┌─────────────────────────────────────┐
│         Kubernetes Cluster          │
│                                     │
│  ┌─────────────────────────────┐    │
│  │      my-blog-project        │    │
│  │         Namespace           │    │
│  │                             │    │
│  │  ┌─────────────────────┐    │    │
│  │  │  Jekyll Blog Pod    │    │    │
│  │  │   Port: 4000        │    │    │
│  │  └─────────────────────┘    │    │
│  │                             │    │
│  │  ┌─────────────────────┐    │    │
│  │  │  FastAPI API Pod    │    │    │
│  │  │   Port: 8080        │    │    │
│  │  └─────────────────────┘    │    │
│  │                             │    │
│  │  ┌─────────────────────┐    │    │
│  │  │  NodePort Services  │    │    │
│  │  │  30081, 30080       │    │    │
│  │  └─────────────────────┘    │    │
│  └─────────────────────────────┘    │
└─────────────────────────────────────┘
```

## 🔧 技術棧

### 前端（Jekyll）
- **靜態網站生成器**: Jekyll
- **主題**: Chirpy
- **樣式**: Sass/CSS
- **容器化**: Docker

### 後端（FastAPI）
- **Web 框架**: FastAPI
- **Python 版本**: 3.11
- **ASGI 伺服器**: Uvicorn
- **容器化**: Docker

### 部署
- **容器編排**: Kubernetes
- **CI/CD**: GitHub Actions
- **容器註冊表**: AWS ECR
- **雲端平台**: AWS EKS

## 📈 擴展性設計

### 1. 水平擴展
- 每個模組可以獨立擴展
- Kubernetes 自動擴展功能
- 負載均衡和服務發現

### 2. 垂直擴展
- 模組化架構便於功能擴展
- 插件系統支援
- 微服務化準備

### 3. 技術擴展
- 支援多種資料庫
- 快取層整合
- 監控和日誌系統

## 🔒 安全性考量

### 1. 容器安全
- 非 root 用戶運行
- 最小化基礎映像
- 定期更新依賴

### 2. 網路安全
- 內部服務不直接暴露
- 使用 NodePort 而非 LoadBalancer
- 網路策略限制

### 3. 應用安全
- 輸入驗證
- 輸出編碼
- 安全標頭

## 📊 監控和日誌

### 1. 健康檢查
- Kubernetes 存活探針
- 就緒探針
- 自定義健康端點

### 2. 日誌管理
- 結構化日誌
- 集中化日誌收集
- 日誌輪轉和保留

### 3. 效能監控
- 資源使用率
- 響應時間
- 錯誤率追蹤
